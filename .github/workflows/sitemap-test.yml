name: Daily Sitemap Test

on:
  schedule:
    #0 → minute (start of the hour)
    #8,20 → hours in UTC (10 AM, 10 PM)
    #* * * → every day of month, every month, every day of week

    - cron: "0 8,20 * * *"  # Runs at 8 AM & 8 PM UTC (10 AM & 10 PM Egypt time)
  workflow_dispatch:  # optional – allows you to run it manually too

jobs:
  test-sitemap:
    runs-on: ubuntu-latest
    environment: email-env

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Set up Java 11 with Maven
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: '11'
          cache: maven

      - name: Log start time
        run: |
          echo "Workflow started at (Egypt): $(TZ=Africa/Cairo date)"

      - name: Build and Run Tests
        run: mvn clean test

      - name: Upload Extent Report
        uses: actions/upload-artifact@v4
        with:
          name: extentReport
          path: test-output/extentReport.html

      - name: Send email with sendgrid
        run: mvn clean test
        env:
          SENDGRID_API_KEY: ${{ secrets.SENDGRID_API_KEY }}
          FROM_EMAIL: ${{ secrets.FROM_EMAIL }}
          TO_EMAIL: ${{ secrets.TO_EMAIL }}


      

